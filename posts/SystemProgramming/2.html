<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
<!-------------------------------------------------------------title goes here  --------------------------------------------------------------------->
<!-------------------------------------------------------------title goes here  --------------------------------------------------------------------->
    <title>[SP]第二週</title>
<!-------------------------------------------------------------title goes here  --------------------------------------------------------------------->
<!-------------------------------------------------------------title goes here  --------------------------------------------------------------------->


    <!-- Bootstrap Core CSS -->
<!---------------------------------------------------------Change CSS relative position here  -------------------------------------------------------->    
<!---------------------------------------------------------Change CSS relative position here  -------------------------------------------------------->
    <link href="../../vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

    <!-- Theme CSS -->
    <link href="../../css/clean-blog.min.css" rel="stylesheet">

    <!-- Custom Fonts -->
    <link href="../../vendor/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
<!---------------------------------------------------------Change CSS relative position here  -------------------------------------------------------->
<!---------------------------------------------------------Change CSS relative position here  -------------------------------------------------------->
    <link href='https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    <!-- 下面這行加入Math Jax 的 LaTex CDN -->
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>

</head>

<body>

    <!-- Navigation -->
    <nav class="navbar navbar-default navbar-custom navbar-fixed-top">
        <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    Menu <i class="fa fa-bars"></i>
                </button>
<!---------------------------------------------------------Change html relative position here  ------------------------------------------------------->        
<!---------------------------------------------------------Change html relative position here  ------------------------------------------------------->        
                <a class="navbar-brand" href="../../index.html">Noob Notes</a>
<!---------------------------------------------------------Change html relative position here  ------------------------------------------------------->        
<!---------------------------------------------------------Change html relative position here  ------------------------------------------------------->        
            </div>



            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav navbar-right">
<!---------------------------------------------------------Change html relative position here  ------------------------------------------------------->
<!---------------------------------------------------------Change html relative position here  ------------------------------------------------------->
                    <li>
                        <a href="../../index.html">Latest</a>
                    </li>
                    <li>
                        <a href="../../about.html">About</a>
                    </li>
                    <li>
                        <a href="../../category.html">Category</a>
                    </li>
                    <!--
                    <li>
                        <a href="../contact.html">Contact</a>
                    </li>
                    -->
<!---------------------------------------------------------Change html relative position here  ------------------------------------------------------->
<!---------------------------------------------------------Change html relative position here  ------------------------------------------------------->
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>

    <!-- Page Header -->
    <!-- Set your background image for this header on the line below. -->
<!---------------------------------------------------------Change URL relative position here  ------------------------------------------------------->   
<!---------------------------------------------------------Change URL relative position here  ------------------------------------------------------->   
    <header class="intro-header" style="background-image: url('../../img/post-bg.jpg')">
<!---------------------------------------------------------Change URL relative position here  ------------------------------------------------------->   
<!---------------------------------------------------------Change URL relative position here  ------------------------------------------------------->   
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    <div class="post-heading">
<!-------------------------------------------------------------------header goes here  --------------------------------------------------------------->
<!-------------------------------------------------------------------header goes here  --------------------------------------------------------------->
                        <h1>[SP]第二週筆記</h1>
                        <h2 class="subheading">我也不知道要上什麼</h2>
                        <span class="meta">Posted by <a>Fernando Lin</a> on 09, 21, 2016</span>
<!-------------------------------------------------------------------header goes here  --------------------------------------------------------------->
<!-------------------------------------------------------------------header goes here  --------------------------------------------------------------->
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Post Content -->
    <article>
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <!--
                    <h2 class="section-heading">用這個來寫標題</h2>
                    <p>用這個寫內文</p>
                    <p>\(...inline latex use this tag...\)</p>
                    <p>$$...Out-of-line latex use this tag...$$</p>
                    <blockquote>用這個寫註解</blockquote>
                -->                        
<!-------------------------------------------------------------------content goes here  --------------------------------------------------------------->
                     
                  <p>今天要學到「電腦怎麼找到檔案」「開一個檔案時會發生什麼事」「打開檔案之後作業系統要怎麼讀寫？」等等議題。</p>
                    <h2 class="section-heading">File System</h2>
                    <p>現在的File System其實是1970年開發出來的檔案系統，不過現在檔案越來越多，所以有點不敷使用中。</p>
                    <img class = "img-responsive" src="1_open_a_file.png" alt="">
                    <p>Storage Device上會切出很多「data block」(比如說4K)，。同一個檔案的data blocks不一定會放在連續的位置。</p>
                    <p>基本上所有table都是一個fd ＋ 檔案名 + 指向去哪裡找資量的pointer。</p>
                    <p>在Tables of Open Files裡面，如果一個Process 開了兩次檔案，那在裡面就會有兩條。但system open table只會出現一個</p>
                    <p>I-core會把邏輯位置轉成物理位置，然後把參數丟給磁碟機叫他讀出相對應的檔案。</p>
                    <p></p>
                    <p>開完檔案之後，要做讀寫。這時候找檔案的方式就直接用fd來找了，然後一路查下去。</p>
                    <p>為什麼要多一個System Open File Table ？ 因為可以有「捷徑」，同一個檔案可以有不同通往他的捷徑。對於system Open File Table中，每個這樣的檔案只會有一個id。</p>
                    <p>開檔之後可以做什麼：</p>
                    <ul>
                        <li>open, close, read, write, lseek, dub</li>
                        <li>fcntl(前面的東西都是用這個東西來實作的，可以說是最基本的。), ioctl</li>
                        <li>chmod, chown：改權限的東西(這個應該滿常用的)</li>
                        <li>mkdir, cd：應該是滿常用的吧～</li>
                    </ul>
                    <h2 class="section-heading">File Descripter</h2>
                    <p>每開一個檔案就會給他一個編號。是一個無號整數，大小從0到OPEN_MAX。每一個Process可以開的檔案有最大上限。</p>
                    <p>作業系統一打開的時候，作業系統會預設開好3個檔案：</p>
                    <ul>
                        <li>0 ： STDIN_FILENO(在Terminal 打東西)</li>
                        <li>1：STDOUT_FILENO(在Terminal 顯示東西)</li>
                        <li>2：STDOUT_FILENO</li>
                        <li>3號以後都是給其他process用了</li>
                    </ul>
                    <p>在Linux 跟UNIX-Like系統中，所有讀寫裝置都會被當成是檔案，比如說鍵盤就是會一直噴東西自動長大的檔案，Terminal螢幕就是一個你要一直寫的東西</p>
                    <p>這3個fd在System Open Table中的同一蘭</p>
                    <p>之後如果有程式開檔，就會一直往下編。編號方法以及要怎麼回收已經關掉的檔案會一作業系統有所不同。舉例來說，可以每次都從下面往下找</p>
                    <h2 class="section-heading">Open()</h2>
                    <p>int open(const char * pathname, int oflag, .../*mode_t mode*/)</p>
                    <p>首先是檔案路徑有上限，不能超過PATH_MAX。檔案名也不能超過NAME_MAX</p>
                    <p>oflag表示檔案讀寫的模式。在開檔的時後就要決定好了。</p>
                    <p>O_RDONLY, O_WRONLY, O_RDWD：檔案讀寫權限。因為每個使用者權限不同，所以不能無腦的通通用O_RDWD。</p>
                    <p>O_APPEND, O_TRUNC：就跟C讀寫檔案的那些參數一樣。</p>
                    <p>O_NONBLOCK：函數做完之後才會回傳，所以呼叫他的函數要等它做完，才會繼續做階下來的事，這就是「Blocking」。Non-Blcking就是可以不等函數回傳，先去做自己的事。
                        Non-Blocking在這裡很重要，因為I/O通常慢，所以如果一直等I/O速度會很慢。
                    </p>
                    <p>O_DSYNC：在寫檔案的時候要不要同步更新到storage device上面。打開的話會比較安全，因為可以立刻存起來，但是速度會很慢，因為Disk I/O很慢。</p>
                    <p></p>


                    
<!-------------------------------------------------------------------content goes here  --------------------------------------------------------------->
                </div>
            </div>
        </div>
    </article>

    <hr>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    <ul class="list-inline text-center">
                        <li>
                            <a>
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="https://www.facebook.com/profile.php?id=100001416766501">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-facebook fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="https://github.com/0xff07">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    </ul>
                    <p class="copyright text-muted">Copyright &copy; Yo-Jung Lin 2016</p>
                </div>
            </div>
        </div>
    </footer>






<!---------------------------------------------------------Change html relative position here  ------------------------------------------------------->
<!---------------------------------------------------------Change html relative position here  ------------------------------------------------------->
    <!-- jQuery -->
    <script src="../../vendor/jquery/jquery.min.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="../../vendor/bootstrap/js/bootstrap.min.js"></script>

    <!-- Contact Form JavaScript -->
    <script src="../../js/jqBootstrapValidation.js"></script>
    <script src="../../js/contact_me.js"></script>

    <!-- Theme JavaScript -->
    <script src="../../js/clean-blog.min.js"></script>
<!---------------------------------------------------------Change html relative position here  ------------------------------------------------------->
<!---------------------------------------------------------Change html relative position here  ------------------------------------------------------->
   




</body>

</html>
